<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Central de Atendimento</title>

<script>
/* ================== TABS ================== */
function openTab(evt, id) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
  evt.target.classList.add('active');
  document.getElementById(id).classList.add('active');
}

/* ================== COMENTÃRIOS ================== */
function atualizarPrefixo() {
  const canal = canalSelect().value;
  const p = protocolo.value.trim();
  if (!p) return;
  comentario.value = `${canal} PROTOCOLO: ${p} - `;
}

function canalSelect() {
  return document.getElementById("canal");
}

function copiarComentario() {
  navigator.clipboard.writeText(comentario.value.toUpperCase());
}

/* ----- ATALHOS ----- */
function atalhoServico(destino) {
  const tipo = prompt("Informe o tipo de serviÃ§o:");
  if (!tipo) return;
  adicionarTexto(`SERVIÃ‡O SOLICITADO E NÃƒO PRESTADO - ${tipo.toUpperCase()} - ENVIADO PARA ${destino}`);
}

function atalhoSegundaVia() {
  adicionarTexto("2Âª FATURA AGORA - ENVIADA");
}

function atalhoFaltaAgua() {
  adicionarTexto("INFORMA FALTA DE ÃGUA - ABERTURA DE SOLICITAÃ‡ÃƒO");
}

function atalhoAbastecimento() {
  const previsao = prompt("Informe a previsÃ£o (ex: 14H 22/09):");
  if (!previsao) return;
  adicionarTexto(`VERIFICAÃ‡ÃƒO SITUAÃ‡ÃƒO ABASTECIMENTO â€“ EXECUTADA (PREVISÃƒO RETORNO ${previsao.toUpperCase()})`);
}

function adicionarTexto(txt) {
  if (!comentario.value.includes("PROTOCOLO")) atualizarPrefixo();
  if (!comentario.value.endsWith(" ")) comentario.value += " ";
  comentario.value += txt;
}

/* ================== PENDÃŠNCIAS ================== */
let pendencias = JSON.parse(localStorage.getItem("pendencias") || "[]");

function salvarPendencia() {
  const mat = prompt("Informe a matrÃ­cula:");
  if (!mat) return;
  pendencias.push({
    matricula: mat,
    texto: comentario.value
  });
  localStorage.setItem("pendencias", JSON.stringify(pendencias));
  carregarPendencias();
  alert("PendÃªncia salva");
}

function carregarPendencias() {
  const tbody = document.getElementById("listaPendencias");
  tbody.innerHTML = "";
  pendencias.forEach((p, i) => {
    tbody.innerHTML += `
      <tr>
        <td>${p.matricula}</td>
        <td>${p.texto.slice(0,60)}...</td>
        <td>
          <span class="icon-btn" onclick="copiarTexto('${p.matricula}')">ðŸ“‹M</span>
          <span class="icon-btn" onclick="copiarTexto('${p.texto.replace(/'/g,"")}')">ðŸ“‹C</span>
          <span class="icon-btn" onclick="excluirPendencia(${i})">ðŸ—‘</span>
        </td>
      </tr>
    `;
  });
}

function copiarTexto(txt) {
  navigator.clipboard.writeText(txt);
}

function excluirPendencia(i) {
  if (!confirm("Excluir pendÃªncia?")) return;
  pendencias.splice(i,1);
  localStorage.setItem("pendencias", JSON.stringify(pendencias));
  carregarPendencias();
}

/* ================== PARALELAS ================== */
function carregarParalela() {
  const tipo = tipoParalela.value;
  let texto = "";

  if (tipo === "cancelamento") texto =
`CANCELAMENTO DE SOLICITAÃ‡ÃƒO

MATRÃCULA:
CIDADE:
PROTOCOLO DO ATENDIMENTO:
SERVIÃ‡O QUE O CLIENTE SOLICITA O CANCELAMENTO:
NÂº SOLICITAÃ‡ÃƒO:
MOTIVO DO CANCELAMENTO:`;

  if (tipo === "pipa") texto =
`CAMINHÃƒO PIPA

PROTOCOLO DO ATENDIMENTO:
BAIRRO:
CIDADE:
MATRÃCULA:
ENDEREÃ‡O:
CELULAR PARA CONTATO:`;

  if (tipo === "retificacao") texto =
`(SERVIÃ‡O) FORA DO PRAZO, REFERENTE Ã€ COMPETÃŠNCIA: XX/XXXX.
DATA DA SOLICITAÃ‡ÃƒO:
MATRÃCULA:
CIDADE:
PROTOCOLO DO ATENDIMENTO:`;

  if (tipo === "debito") texto =
`BLOQUEAR DÃ‰BITO EM CONTA

MATRÃCULA:
CIDADE:
PROTOCOLO DO ATENDIMENTO:
VENCIMENTO: XX/XX/XXXX
VALOR: R$
COMPETÃŠNCIA: XX/XXXX`;

  if (tipo === "exclusao") texto =
`EXCLUSÃƒO DE CADASTRO DO SITE/APP

NOME COMPLETO:
MATRÃCULA:
CONCESSÃƒO: CORSAN
CPF OU CNPJ CADASTRADO:
E-MAIL CADASTRADO:
CPF OU CNPJ CORRETO:
MOTIVO DA SOLICITAÃ‡ÃƒO DE EXCLUSÃƒO: DADOS INCORRETOS`;

  if (tipo === "religacao") texto =
`RELIGAÃ‡ÃƒO POR CORTE INDEVIDO â€“ REGIONAL â€“ O.S. XXXXXXX â€“ PROTOCOLO: XXXXXXX

MATRÃCULA:
CIDADE:
PROTOCOLO DO ATENDIMENTO:
VENCIMENTO: XX/XX/XXXX`;

  textoParalela.value = texto;
}

function copiarParalela() {
  navigator.clipboard.writeText(textoParalela.value);
}

/* ================== O.S. ================== */
const OS_DATA = {
  troca_mov: ["MATRÃCULA","ENDEREÃ‡O","CIDADE","NOVO TITULAR","CPF DO NOVO TITULAR","DATA DA MOVIMENTAÃ‡ÃƒO","LEITURA","OBSERVAÃ‡Ã•ES"],
  troca_manual: ["MATRÃCULA","ENDEREÃ‡O","CIDADE","NOVO TITULAR","CPF","OBSERVAÃ‡Ã•ES"],
  troca_excecao: ["MATRÃCULA","ENDEREÃ‡O","CIDADE","NOVO TITULAR","CPF","MOTIVO DA EXCEÃ‡ÃƒO"],
  tarifa: ["MATRÃCULA","CIDADE","CPF","NIS","OBSERVAÃ‡Ã•ES"],
  verificacao: ["MATRÃCULA","CIDADE","INFORMAÃ‡ÃƒO"],
  supressao: ["MATRÃCULA","CIDADE","MOTIVO"],
  vaz_quadro: ["MATRÃCULA","CIDADE","DESCRIÃ‡ÃƒO"],
  vaz_rua: ["ENDEREÃ‡O","CIDADE","REFERÃŠNCIA"],
  falta_agua: ["MATRÃCULA","CIDADE","OBSERVAÃ‡Ã•ES"]
};

function carregarOS() {
  const tipo = tipoOS.value;
  camposOS.innerHTML = "";
  if (!OS_DATA[tipo]) return;
  OS_DATA[tipo].forEach(c => {
    camposOS.innerHTML += `<label>${c}</label><input data-os="${c}">`;
  });
  atualizarOS();
}

document.addEventListener("input", e => {
  if (e.target.closest("#os")) atualizarOS();
});

function atualizarOS() {
  const tipo = tipoOS.value;
  if (!OS_DATA[tipo]) return;
  let texto = tipoOS.selectedOptions[0].text.toUpperCase() + "\n\n";
  document.querySelectorAll("#camposOS input").forEach(i => {
    texto += i.dataset.os + ": " + i.value + "\n";
  });
  textoOS.value = texto.toUpperCase();
}

function copiarOS() {
  navigator.clipboard.writeText(textoOS.value);
}

/* INIT */
carregarPendencias();
  const OS_INSTRUCOES = {
  vaz_rua: "Confirmar endereÃ§o completo e ponto de referÃªncia.",
  vaz_quadro: "Orientar cliente a fechar o registro se possÃ­vel.",
  falta_agua: "Confirmar se hÃ¡ previsÃ£o e regiÃ£o afetada."
};

function iniciarOS() {
  const tipo = tipoOS.value;
  const nome = osNome.value.trim();
  const tel = osTelefone.value.trim();

  if (!tipo || !nome || !tel) {
    alert("Preencha tipo de O.S., nome e telefone.");
    return;
  }

  document.getElementById("os-step-1").style.display = "none";
  document.getElementById("os-step-2").style.display = "block";

  osInstrucoes.innerText = OS_INSTRUCOES[tipo] || "Siga o procedimento padrÃ£o.";

  carregarOS();
}

</script>

  
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f4f4f4;
}

header {
  background: #2f3e46;
  color: #fff;
  padding: 14px;
  text-align: center;
  font-weight: bold;
}

.tabs {
  display: flex;
  background: #cad2c5;
}

.tab {
  padding: 10px 16px;
  cursor: pointer;
  border-right: 1px solid #999;
}

.tab.active {
  background: #fff;
  font-weight: bold;
}

.content {
  display: none;
  padding: 16px;
  background: #fff;
  height: calc(100vh - 90px);
  overflow-y: auto;
}

.content.active {
  display: block;
}

label {
  font-weight: bold;
  display: block;
  margin-top: 10px;
}

input, textarea, select {
  width: 100%;
  padding: 8px;
  margin-top: 4px;
  box-sizing: border-box;
}

textarea {
  resize: vertical;
}

button {
  padding: 10px;
  margin-top: 10px;
  cursor: pointer;
}

.btn {
  background: #2f3e46;
  color: #fff;
  border: none;
  font-weight: bold;
}

.btn-full {
  width: 100%;
}

.row {
  display: flex;
  gap: 10px;
}

.row button {
  flex: 1;
}

.box {
  background: #eee;
  padding: 10px;
  margin-top: 10px;
  font-size: 13px;
}

.table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}

.table th, .table td {
  border: 1px solid #ccc;
  padding: 6px;
  font-size: 13px;
}

.icon-btn {
  cursor: pointer;
  margin-right: 6px;
}
</style>
</head>

<body>

<header>CENTRAL DE ATENDIMENTO</header>

<div class="tabs">
  <div class="tab active" onclick="openTab(event,'comentarios')">ComentÃ¡rios</div>
  <div class="tab" onclick="openTab(event,'pendencias')">PendÃªncias</div>
  <div class="tab" onclick="openTab(event,'paralelas')">Paralelas</div>
  <div class="tab" onclick="openTab(event,'os')">O.S.</div>
</div>

<!-- ================= COMENTÃRIOS ================= -->
<div id="comentarios" class="content active">

  <label>Canal</label>
  <select id="canal">
    <option>CALL CENTER</option>
    <option>LOJA</option>
  </select>

  <label>Protocolo</label>
  <input id="protocolo" oninput="atualizarPrefixo()">

  <label>ComentÃ¡rio</label>
  <textarea id="comentario" rows="4"></textarea>

  <div class="row">
    <button class="btn" onclick="atalhoServico('FORMS')">ServiÃ§o nÃ£o prestado â€“ Forms</button>
    <button class="btn" onclick="atalhoServico('SUPERVISORA')">ServiÃ§o nÃ£o prestado â€“ Supervisora</button>
  </div>

  <button class="btn btn-full" onclick="atalhoSegundaVia()">2Âª VIA ENVIADA</button>

  <button class="btn btn-full" onclick="atalhoAbastecimento()">VerificaÃ§Ã£o situaÃ§Ã£o abastecimento</button>

  <button class="btn btn-full" onclick="atalhoFaltaAgua()">Informa falta de Ã¡gua</button>

  <div class="row">
    <button class="btn" onclick="copiarComentario()">COPIAR</button>
    <button class="btn" onclick="salvarPendencia()">SALVAR PENDÃŠNCIA</button>
  </div>

</div>

<!-- ================= PENDÃŠNCIAS ================= -->
<div id="pendencias" class="content">

  <table class="table">
    <thead>
      <tr>
        <th>MatrÃ­cula</th>
        <th>ComentÃ¡rio</th>
        <th>AÃ§Ãµes</th>
      </tr>
    </thead>
    <tbody id="listaPendencias"></tbody>
  </table>

</div>

<!-- ================= PARALELAS ================= -->
<div id="paralelas" class="content">

  <div class="box">
    <b>SUPERVISORES</b><br>
    kleber.filho@aeparceiros.com.br<br>
    victoria.ferreira@aeparceiros.com.br<br>
    barbara.piva@aeparceiros.com.br
  </div>

  <label>Tipo de paralela</label>
  <select id="tipoParalela" onchange="carregarParalela()">
    <option value="">Selecione</option>
    <option value="cancelamento">Cancelamento de solicitaÃ§Ã£o</option>
    <option value="pipa">CaminhÃ£o pipa</option>
    <option value="retificacao">RetificaÃ§Ã£o fora do prazo</option>
    <option value="debito">Bloquear dÃ©bito</option>
    <option value="exclusao">ExclusÃ£o cadastro</option>
    <option value="religacao">ReligaÃ§Ã£o corte indevido</option>
  </select>

  <label>Texto do e-mail</label>
  <textarea id="textoParalela" rows="10"></textarea>

  <button class="btn btn-full" onclick="copiarParalela()">COPIAR</button>

</div>

<!-- ================= O.S. ================= -->
<div id="os" class="content">

  <!-- ETAPA 1 -->
  <div id="os-step-1">
    <label>Tipo de O.S.</label>
    <select id="osTipo">
      <option value="">Selecione</option>
      <option value="148005">148005 â€“ Troca de titularidade (manual / quantitativa)</option>
      <option value="248005_exc">248005 â€“ Troca de titularidade (com exceÃ§Ãµes)</option>
      <option value="248005_mov">248005 â€“ Troca de titularidade (com movimentaÃ§Ã£o de dÃ©bitos)</option>
      <option value="103002">103002 â€“ Tarifa social</option>
      <option value="102002">102002 â€“ VerificaÃ§Ã£o cadastral</option>
      <option value="118061">118061 â€“ SupressÃ£o de ligaÃ§Ã£o de esgoto</option>
      <option value="119001">119001 â€“ Vazamento no quadro</option>
      <option value="138001">138001 â€“ Vazamento na rua ou calÃ§ada</option>
      <option value="146004">146004 â€“ Falta de Ã¡gua</option>
    </select>

    <label>Nome do cliente</label>
    <input id="osNome">

    <label>Telefone do cliente</label>
    <input id="osTelefone">

    <button class="btn btn-full" onclick="iniciarOS()">CONTINUAR</button>
  </div>

  <!-- ETAPA 2 -->
  <div id="os-step-2" style="display:none;">

    <div class="box" id="osInstrucoes"></div>

    <div id="osCampos"></div>

    <label>Texto da O.S.</label>
    <textarea id="osTexto" rows="10"></textarea>

    <button id="btn148006" class="btn btn-full" style="display:none;" onclick="gerar148006()">
      GERAR TEXTO OS 148006 â€“ TRANSFERÃŠNCIA DE DÃ‰BITO
    </button>

    <button class="btn btn-full" onclick="copiarOSTexto()">COPIAR</button>

  </div>
</div>


  <!-- ETAPA 2 -->
  <div id="os-step-2" style="display:none;">
    <div class="box" id="osInstrucoes"></div>

    <div id="camposOS"></div>

    <label>Texto da O.S.</label>
    <textarea id="textoOS" rows="10"></textarea>

    <button class="btn btn-full" onclick="copiarOS()">COPIAR</button>
  </div>

</div>

