<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Central de Atendimento</title>

<style>
body { font-family: Arial, sans-serif; margin:0; background:#f4f4f4; }
header { background:#2f3e46; color:#fff; padding:14px; text-align:center; font-weight:bold; }

.tabs { display:flex; background:#cad2c5; }
.tab { padding:10px 16px; cursor:pointer; border-right:1px solid #999; }
.tab.active { background:#fff; font-weight:bold; }

.content {
  display:none;
  padding:16px;
  background:#fff;
  height:calc(100vh - 90px);
  overflow-y:auto;
}
.content.active { display:block; }

button { padding:12px; cursor:pointer; font-size:14px; }

label { font-weight:bold; display:block; margin-top:10px; }
input, textarea {
  width:100%; padding:8px; margin-top:4px; box-sizing:border-box;
}
textarea { resize:vertical; }

.btn-full {
  width:100%; margin-top:14px;
  background:#2f3e46; color:#fff; border:none; font-weight:bold;
}

.presets {
  display:grid;
  grid-template-columns:1fr;
  gap:8px;
  margin-top:12px;
}

/* Modal variável */
.modal {
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.4);
  z-index:20;
}
.modal-content {
  background:#fff;
  padding:20px;
  width:300px;
  margin:120px auto;
}
</style>
</head>

<body>

<header>CENTRAL DE ATENDIMENTO</header>

<div class="tabs">
  <div class="tab active">Comentários</div>
</div>

<div class="content active">

  <label>Protocolo</label>
  <input id="protocolo" placeholder="Digite o protocolo" oninput="gerarInicio()">

  <label>Comentário</label>
  <textarea id="comentario" rows="4"></textarea>

  <div class="presets">
    <button onclick="usarPresetSimples('2ª FATURA ENVIADA')">
      2ª FATURA ENVIADA
    </button>

    <button onclick="presetVariavel(
      'SERVIÇO SOLICITADO E NÃO PRESTADO – {VAR} – ENVIADO VIA FORMS',
      'Digite o tipo de serviço'
    )">
      Serviço não prestado – Forms
    </button>

    <button onclick="presetVariavel(
      'SERVIÇO SOLICITADO E NÃO PRESTADO – {VAR} – ENVIADO PARA SUPERVISORA',
      'Digite o tipo de serviço'
    )">
      Serviço não prestado – Supervisora
    </button>
  </div>

  <button class="btn-full" onclick="copiarComentario()">COPIAR COMENTÁRIO</button>
</div>

<!-- MODAL VARIÁVEL -->
<div id="modalVar" class="modal">
  <div class="modal-content">
    <label id="labelVar"></label>
    <input id="inputVar">
    <button class="btn-full" onclick="confirmarVariavel()">OK</button>
  </div>
</div>

<script>
// CONFIGURAÇÃO (vem das configs futuramente)
let tipoAtendimento = "CALL CENTER";

let modeloAtual = "";

// Referências corretas
const protocoloInput = document.getElementById("protocolo");
const comentario = document.getElementById("comentario");
const modalVar = document.getElementById("modalVar");
const labelVar = document.getElementById("labelVar");
const inputVar = document.getElementById("inputVar");

function gerarInicio() {
  const protocolo = protocoloInput.value.trim();
  if (!protocolo) return;

  const inicio = `${tipoAtendimento} PROTOCOLO: ${protocolo} - `;

  if (!comentario.value.startsWith(inicio)) {
    comentario.value = inicio;
  }
}

function usarPresetSimples(txt) {
  if (!comentario.value.endsWith(" ")) comentario.value += " ";
  comentario.value += txt;
}

function presetVariavel(modelo, label) {
  modeloAtual = modelo;
  labelVar.innerText = label;
  inputVar.value = "";
  modalVar.style.display = "block";
  inputVar.focus();
}

function confirmarVariavel() {
  const valor = inputVar.value.trim().toUpperCase();
  if (!valor) return;

  const texto = modeloAtual.replace("{VAR}", valor);

  if (!comentario.value.endsWith(" ")) comentario.value += " ";
  comentario.value += texto;

  modalVar.style.display = "none";
}

inputVar.addEventListener("keydown", e => {
  if (e.key === "Enter") confirmarVariavel();
});

function copiarComentario() {
  let texto = comentario.value.replace(/\n/g, " ").toUpperCase();
  navigator.clipboard.writeText(texto);
  alert("Comentário copiado!");
}
</script>

</body>
</html>
